<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>GitHub Repos Sunburst — chasenunez</title>
<style>
  body { font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 20px; display:flex; flex-direction:column; align-items:center; background:white; color:#222; }
  #chart { width: 100%; max-width: 1100px; height: 800px; }
  svg { width: 100%; height: 100%; }
  .center-label { font-size: 14px; text-anchor: middle; fill: #222; }
  .tooltip { position: absolute; pointer-events: none; background: rgba(0,0,0,0.75); color: white; padding: 6px 8px; border-radius: 4px; font-size: 12px; }
  button { margin: 8px; }
</style>
</head>
<body>
<h2>Repos &amp; languages — interactive sunburst</h2>
<div>
  <button id="resetBtn">Reset</button>
</div>
<div id="chart"></div>
<div id="label" style="margin-top:8px">Click a wedge to zoom / click center to reset.</div>
<div id="tooltip" class="tooltip" style="display:none"></div>
<!-- inlined data -->
<script id="flare-data" type="application/json">
{
  "name": "root",
  "children": [
    {
      "name": "Private",
      "children": [
        {
          "name": "R",
          "size": 114370
        },
        {
          "name": "HTML",
          "size": 9253425
        },
        {
          "name": "TeX",
          "size": 285515
        },
        {
          "name": "Python",
          "size": 375905
        },
        {
          "name": "Rust",
          "size": 346478
        },
        {
          "name": "Makefile",
          "size": 1490
        },
        {
          "name": "JavaScript",
          "size": 78987
        },
        {
          "name": "CSS",
          "size": 75820
        },
        {
          "name": "SCSS",
          "size": 58439
        },
        {
          "name": "Shell",
          "size": 2768
        },
        {
          "name": "Jupyter Notebook",
          "size": 78593988
        },
        {
          "name": "Smalltalk",
          "size": 98772
        },
        {
          "name": "C#",
          "size": 19771
        },
        {
          "name": "C++",
          "size": 68
        },
        {
          "name": "PHP",
          "size": 53
        },
        {
          "name": "C",
          "size": 46
        }
      ]
    },
    {
      "name": "chasenunez",
      "children": [
        {
          "name": "Python",
          "size": 65940367
        },
        {
          "name": "C",
          "size": 408938
        },
        {
          "name": "Cython",
          "size": 103945
        },
        {
          "name": "C++",
          "size": 85980
        },
        {
          "name": "Fortran",
          "size": 36224
        },
        {
          "name": "PowerShell",
          "size": 8834
        },
        {
          "name": "JavaScript",
          "size": 8662
        },
        {
          "name": "Smarty",
          "size": 8486
        },
        {
          "name": "Meson",
          "size": 4220
        },
        {
          "name": "Shell",
          "size": 2874
        }
      ]
    },
    {
      "name": "envidat_entrails",
      "children": [
        {
          "name": "HTML",
          "size": 19439431
        },
        {
          "name": "Python",
          "size": 28258
        }
      ]
    },
    {
      "name": "tui_log",
      "children": [
        {
          "name": "Rust",
          "size": 346478
        },
        {
          "name": "Makefile",
          "size": 1490
        }
      ]
    },
    {
      "name": "contribution_chart",
      "children": [
        {
          "name": "TypeScript",
          "size": 180801
        },
        {
          "name": "JavaScript",
          "size": 570
        }
      ]
    },
    {
      "name": "trmnlp",
      "children": [
        {
          "name": "JavaScript",
          "size": 41714
        },
        {
          "name": "Ruby",
          "size": 41108
        },
        {
          "name": "HTML",
          "size": 2789
        },
        {
          "name": "CSS",
          "size": 1111
        },
        {
          "name": "Shell",
          "size": 864
        },
        {
          "name": "Dockerfile",
          "size": 725
        },
        {
          "name": "Liquid",
          "size": 49
        }
      ]
    },
    {
      "name": "byos_django",
      "children": [
        {
          "name": "Python",
          "size": 33966
        },
        {
          "name": "HTML",
          "size": 4385
        },
        {
          "name": "Dockerfile",
          "size": 474
        }
      ]
    },
    {
      "name": "logue",
      "children": [
        {
          "name": "Python",
          "size": 28643
        }
      ]
    },
    {
      "name": "data_HUD",
      "children": [
        {
          "name": "JavaScript",
          "size": 11753
        },
        {
          "name": "HTML",
          "size": 3773
        },
        {
          "name": "CSS",
          "size": 1543
        }
      ]
    },
    {
      "name": "sunburst_nav",
      "children": [
        {
          "name": "HTML",
          "size": 9941
        },
        {
          "name": "CSS",
          "size": 313
        }
      ]
    },
    {
      "name": "solar_nav",
      "children": [
        {
          "name": "Python",
          "size": 6409
        }
      ]
    },
    {
      "name": "recursive_shrink",
      "children": [
        {
          "name": "Shell",
          "size": 2036
        }
      ]
    },
    {
      "name": "etani_shordul",
      "children": [
        {
          "name": "Python",
          "size": 1405
        }
      ]
    }
  ]
}
</script>
<script src="https://d3js.org/d3.v7.min.js"></script>
<script>
(function () {
  const raw = document.getElementById('flare-data').textContent;
  let data;
  try {
    data = JSON.parse(raw);
  } catch (e) {
    console.error('Failed to parse inlined JSON', e);
    document.getElementById('label').textContent = 'Failed to load data.';
    return;
  }

  const width = 1100, height = 800, radius = Math.min(width, height) / 2;
  const chart = d3.select("#chart");
  const svg = chart.append("svg")
    .attr("viewBox", [-width/2, -height/2, width, height]);

  const g = svg.append("g");

  const partition = (data) => {
    const root = d3.hierarchy(data)
      .sum(d => d.size || 0)
      .sort((a, b) => b.value - a.value);
    return d3.partition()
      .size([2 * Math.PI, root.height + 1])
      (root);
  };

  const arc = d3.arc()
    .startAngle(d => d.x0)
    .endAngle(d => d.x1)
    .padAngle(d => Math.min((d.x1 - d.x0) / 2, 0.01))
    .padRadius(radius * 1.5)
    .innerRadius(d => d.y0 * (radius / (d.depth+1)))
    .outerRadius(d => Math.max(d.y0 * (radius / (d.depth+1)), d.y1 * (radius / (d.depth+1))));

  function colorFor(name) {
    let h = 0;
    for (let i=0;i<name.length;i++) h = (h<<5)-h + name.charCodeAt(i);
    const hue = Math.abs(h) % 360;
    return `hsl(${hue} 60% 55%)`;
  }

  const tooltip = d3.select("#tooltip");

  const root = partition(data);
  root.each(d => d.current = d);

  const slice = g.append("g")
    .selectAll("path")
    .data(root.descendants().slice(1))
    .join("path")
      .attr("fill", d => colorFor(d.data.name || d.data))
      .attr("fill-opacity", 1)
      .attr("d", d => arc(d.current))
      .style("cursor", "pointer")
      .on("click", clicked)
      .on("mouseover", (event,d) => {
         tooltip.style("display", "block")
           .html(`<strong>${d.data.name}</strong><br/>${d.value} bytes`);
      })
      .on("mousemove", (event) => {
         tooltip.style("left", (event.pageX + 10) + "px").style("top", (event.pageY + 10) + "px");
      })
      .on("mouseout", () => tooltip.style("display","none"));

  slice.append("title").text(d => `${d.ancestors().map(d => d.data.name).reverse().join(" / ")}\n${d.value}`);

  const labelGroup = g.append("g")
    .attr("pointer-events", "none")
    .attr("text-anchor", "middle")
    .selectAll("text")
    .data(root.descendants().slice(1))
    .join("text")
      .attr("dy", "0.35em")
      .attr("transform", d => {
        const x = (d.x0 + d.x1) / 2 * 180 / Math.PI;
        const y = (d.y0 + d.y1) / 2 * radius / (d.depth+1);
        return `rotate(${x - 90}) translate(${y},0) rotate(${x < 180 ? 0 : 180})`;
      })
      .text(d => d.depth === 1 ? d.data.name : (d.depth === 2 ? d.data.name : ""))
      .style("font-size", "12px");

  function clicked(p) {
    if (!p) return;
    const rootd = p;
    root.each(d => d.target = {
      x0: Math.max(0, Math.min(2 * Math.PI, (d.x0 - rootd.x0) * (2*Math.PI) / (rootd.x1 - rootd.x0))),
      x1: Math.max(0, Math.min(2 * Math.PI, (d.x1 - rootd.x0) * (2*Math.PI) / (rootd.x1 - rootd.x0))),
      y0: Math.max(0, d.y0 - rootd.depth),
      y1: Math.max(0, d.y1 - rootd.depth)
    });

    const t = g.transition().duration(750);

    slice.transition(t)
        .tween("data", d => {
          const i = d3.interpolate(d.current, d.target);
          return t => d.current = i(t);
        })
        .attrTween("d", d => () => arc(d.current));
  }

  d3.select("#resetBtn").on("click", () => clicked(root));
  svg.on("click", (event) => {
    if (event.target.tagName === 'svg' || event.target.tagName === 'DIV') clicked(root);
  });
})();
</script>
</body>
</html>
